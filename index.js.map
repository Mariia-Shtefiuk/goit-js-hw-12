{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst DEFAULT_PER_PAGE = 15;\nconst API_KEY = '50948492-7a2c95c1e3ac536ddbec900a1';\n\nexport async function getImagesByQuery(query, page) {\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: API_KEY,\n      q: query,\n      page,\n      per_page: DEFAULT_PER_PAGE,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n    },\n  });\n\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst lightbox = new SimpleLightbox('.gallery a');\nconst loader = document.querySelector('.loader');\nconst loadMore = document.querySelector('.load-more');\n\nexport const createGallery = images => {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return ` \n  <li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"200\">\n        </a>\n        <div class=\"img-info\">\n            <div class=\"img-stat\">\n                <span class=\"sub-title\">Likes</span>\n                <span class=\"value\">${likes}</span>\n            </div>\n            <div class=\"img-stat\">\n                <span class=\"sub-title\">Views</span>\n                <span class=\"value\">${views}</span>\n            </div>\n            <div class=\"img-stat\">\n                <span class=\"sub-title\">Comments</span>\n                <span class=\"value\">${comments}</span>\n            </div>\n            <div class=\"img-stat\">\n                <span class=\"sub-title\">Downloads</span>\n                <span class=\"value\">${downloads}</span>\n            </div>\n        </div>\n    </li>\n  `;\n      }\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n};\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  loader.classList.add('hidden');\n}\n\nexport const showLoadMoreButton = () => {\n  loadMore.classList.remove('hidden');\n};\n\nexport const hideLoadMoreButton = () => {\n  loadMore.classList.add('hidden');\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getImagesByQuery } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions.js';\n\nconst DEFAULT_PAGE = 1;\n\nexport class Search {\n  query;\n  page;\n  loadedImages;\n  totalHits;\n\n  constructor() {\n    this.query = '';\n    this.page = DEFAULT_PAGE;\n    this.loadedImages = 0;\n    this.totalHits = 0;\n  }\n\n  smoothScrollAfterLoad() {\n    const card = document.querySelector('.gallery-item');\n    if (!card) return;\n\n    const cardHeight = card.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n\n  handleSearchChange(event) {\n    const newQuery = event.target.value.trim();\n\n    if (this.query !== newQuery) {\n      this.page = DEFAULT_PAGE;\n    }\n\n    this.query = newQuery;\n  }\n\n  async handleSubmit(event) {\n    event.preventDefault();\n\n    if (!this.query) {\n      iziToast.warning({\n        title: 'Caution',\n        message: \"Input can't be empty!\",\n        position: 'topRight',\n      });\n    }\n\n    if (this.page === DEFAULT_PAGE) {\n      this.loadedImages = 0;\n      this.totalHits = 0;\n      clearGallery();\n    }\n\n    showLoader();\n    hideLoadMoreButton();\n\n    try {\n      const data = await getImagesByQuery(this.query, this.page);\n\n      if (!data.hits.length) {\n        iziToast.error({\n          title: 'Error',\n          message: 'Sorry, no images for your search',\n          position: 'topRight',\n        });\n        return;\n      }\n\n      this.loadedImages += data.hits.length;\n      this.totalHits = data.totalHits;\n\n      createGallery(data.hits);\n      if (this.page !== DEFAULT_PAGE) {\n        this.smoothScrollAfterLoad();\n      }\n\n      if (this.loadedImages < this.totalHits) {\n        showLoadMoreButton();\n      } else {\n        hideLoadMoreButton();\n        iziToast.info({\n          title: 'Info',\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    } catch (error) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Sorry, something went wrong. Please try again later',\n        position: 'topRight',\n      });\n    } finally {\n      hideLoader();\n    }\n  }\n\n  async handleLoadMore(event) {\n    this.page += 1;\n\n    await this.handleSubmit(event);\n  }\n}\n\nconst search = new Search();\n\nconst form = document.querySelector('.form');\nconst input = form.querySelector('input[name=\"search-text\"]');\nconst loadMore = document.querySelector('.load-more');\n\ninput.addEventListener('change', event => search.handleSearchChange(event));\nform.addEventListener('submit', event => search.handleSubmit(event));\nloadMore.addEventListener('click', event => search.handleLoadMore(event));\n"],"names":["DEFAULT_PER_PAGE","API_KEY","getImagesByQuery","query","page","axios","gallery","lightbox","SimpleLightbox","loader","loadMore","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","DEFAULT_PAGE","Search","__publicField","card","cardHeight","event","newQuery","iziToast","data","search","form","input"],"mappings":"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"}